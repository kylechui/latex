\documentclass[class=article, crop=false]{standalone}
\input{../../Preamble}

\fancyhf{}
\lhead{Kyle Chui}
\rhead{Page \thepage}
\pagestyle{fancy}

\begin{document}
  \section{Lecture 7}
  If we consider the error generated by the fixed point iteration method, $e_n = \abs{p - p_n}$, we have that this is equal to $\abs{g(p) - g(p_{n - 1})}$, where $g\in C[p, p_{n - 1}]$. By Mean Value Theorem we know that there exists some $\xi\in (p, p_{n - 1})$ such that
  \begin{align*}
    \abs{g(p) - g(p_{n - 1})} &= \abs{g'(\xi)} \abs{p - p_{n - 1}} \\
                              &= \abs{g'(\xi)}e_{n - 1}.
  \end{align*}
  Hence if $e_n < e_{n - 1}$ then $\abs{g'(\xi)} < 1$ and the fixed point iteration converges to $p$. On the other hand, if $e_n\geq e_{n - 1}$, then $\abs{g'(\xi)}\geq 1$ and the fixed point iteration diverges.
  \begin{theorem}{Convergence of the Fixed Point Iteration}
    Let $g(x)\in C[a, b]$ such that $g(x)\in [a, b]$ for all $x\in [a, b]$. Furthermore, suppose that $g'(x)$ exists on $(a, b)$ and there exists $0 < k < 1$ such that
    \[
      \abs{g'(x)}\leq k\quad\text{for all }x\in (a, b).
    \]
    Then for any $p_0\in [a, b]$, the sequence defined by $p_n = g(p_n - 1)$ for all $n\geq 1$ converges to the unique fixed-point $p$ in $[a, b]$.
    \begin{proof}
      Let $p_0\in [a, b]$. Then
      \begin{align*}
        \abs{p - p_n} &= \abs{g(p) - g(p_{n - 1})} \\
                      &= \abs{g'(\xi)(p - p_{n - 1})} \tag{$\xi\in (p, p_{n - 1})\subset [a, b]$} \\
                      &= \abs{g'(\xi)}\abs{p - p_{n - 1}} \\
                      &\leq k\abs{p - p_{n - 1}} \\
                      &\leq k^2 \abs{p - p_{n - 2}} \\
                      &\leq \dotsb \\
                      &\leq k^n \abs{p - p_0}.
      \end{align*}
      Hence
      \begin{align*}
        \lim_{n\to \infty} \abs{p - p_n} &\leq \lim_{n\to \infty} k^n\abs{p - p_0} \\
                                         &= \abs{p - p_0}\lim_{n\to \infty} k^n \\
                                         &= 0.
      \end{align*}
      Thus $\lim\limits_{n\to \infty} \abs{p - p_n} = 0$, so $p_n\to p$ for any $p_0\in [a, b]$.
    \end{proof}
  \end{theorem}
  \textbf{Error Analysis.} We want to bound $\abs{p - p_n}$ by some known values. Since $p_0\in [a, b]$ and $\abs{p - p_n} \leq k^n\abs{p - p_0}$, we have
  \[
    \abs{p - p_n} \leq k^n \max\set{\abs{a - p_0}, \abs{b - p_0}}.
  \]
  We can then use this equation to find the number of iterations required to get to a certain error bound. If we want to have some error bound of $\eps$, then
  \begin{align*}
    k^n\max \set{\abs{a - p_0}, \abs{b - p_0}} &\leq \eps \\
    k^n &\leq \frac{\eps}{\max\set{\abs{a - p_0}, \abs{b - p_0}}} \\
    n\log k &\leq \log \frac{\eps}{\max\set{\abs{a - p_0}, \abs{b - p_0}}} \\
    n &\geq \frac{\eps}{\max\set{\abs{a - p_0}, \abs{b - p_0}}\cdot \log k} \tag{$\log k < 0$}.
  \end{align*}
\end{document}
